############################################
# Created by: Allison Bertie Johnson 
# Working Directory: /home/abj15/Research.Project
# Mannual: https://github.com/vibansal/HapCUT2/blob/master/README.md
#	- detailed paths for specific directories provided below
# Datasets, alignments & runs of real aligned data on HapCUT, HapCUT2, HapSeq & HapCompass
###############################################
# Creating new Dataset directory and coping  datasets 826T, 827T, 832T, 847T & 850T
#
[abj15@login1 Research.Project]$ mv Datasets/ Trash/
[abj15@login1 Research.Project]$ ls
Alignments  Run  Software  Trash  Work

[abj15@login1 Research.Project]$ mkdir Datasets
[abj15@login1 Research.Project]$ cd Datasets/
[abj15@login1 Datasets]$ mkdir 826T
[abj15@login1 Datasets]$ mkdir 827T
[abj15@login1 Datasets]$ mkdir 832T
[abj15@login1 Datasets]$ mkdir 847T
[abj15@login1 Datasets]$ mkdir 850T

[abj15@login1 Datasets]$ ls
826T  827T  832T  847T  850T

[abj15@login1 Datasets]$ cd 826T/
[abj15@login1 826T]$ cp /group/hon/hon3398o/0.course.files/Data/seq.data/NGS.hap/826T_* .

[abj15@login1 826T]$ ls
826T_1_sequence.txt  826T_2_sequence.txt

[abj15@login1 826T]$ cd ..
[abj15@login1 Datasets]$ cd 827T/
[abj15@login1 827T]$ cp /group/hon/hon3398o/0.course.files/Data/seq.data/NGS.hap/827T_* .
[abj15@login1 827T]$ cd ../832T/
[abj15@login1 832T]$ cp /group/hon/hon3398o/0.course.files/Data/seq.data/NGS.hap/832T_* .
[abj15@login1 832T]$ cd ../847T/
[abj15@login1 847T]$ cp /group/hon/hon3398o/0.course.files/Data/seq.data/NGS.hap/847T_* .
[abj15@login1 847T]$ cd ../850T/
[abj15@login1 850T]$ cp /group/hon/hon3398o/0.course.files/Data/seq.data/NGS.hap/850T_* .

[abj15@login1 850T]$ ls
850T_1_sequence.txt  850T_2_sequence.txt

##############################################
# Next we run bwa and samtools on each Pair-End Dataset to create .bam files
##############################################
#
# 826T: we take the last 4 million lines aka last 1 million reads 
# Working Directory: /home/abj15/Research.Project/Datasets/826T/6.8.2019

[abj15@login1 Datasets]$ cd 826T/
[abj15@login1 826T]$ mkdir 6.8.2019
[abj15@login1 826T]$ ls
6.8.2019  826T_1_sequence.txt  826T_2_sequence.txt
[abj15@login1 826T]$ cd 6.8.2019/
[abj15@login1 6.8.2019]$ tail -4000000 ../826T_1_sequence.txt >1mil.826T_1.txt
[abj15@login1 6.8.2019]$ ls
1mil.826T_1.txt
[abj15@login1 6.8.2019]$ tail -4000000 ../826T_2_sequence.txt >1mil.826T_2.txt
[abj15@login1 6.8.2019]$ ls
1mil.826T_2.txt  1mil.826T_1.txt

##########################################################
# Next we run bwa on the two newly created files
# Path for bwa: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa
# align to hg38
# Path for hg38: /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 
# First we create .sai files of both 826T_1 and 826T_2
###########################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.826T_1.txt >1mil.826T_1.sai

[bwa_aln_core] calculate SA coordinate... 31.45 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 31.29 sec
[bwa_aln_core] write to the disk... 0.05 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 33.24 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 786432 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 26.49 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 1000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.826T_1.txt
[main] Real time: 31.962 sec; CPU: 137.588 sec

[abj15@login1 6.8.2019]$ ls
1mil.826T_1.sai  1mil.826T_1.txt  1mil.826T_2.txt


[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.826T_2.txt >1mil.826T_2.sai

[bwa_aln_core] calculate SA coordinate... 33.17 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 32.52 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 32.18 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 786432 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 24.69 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 1000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.826T_2.txt
[main] Real time: 34.914 sec; CPU: 140.581 sec

[abj15@login1 6.8.2019]$ ls
1mil.826T_1.sai  1mil.826T_1.txt  1mil.826T_2.sai  1mil.826T_2.txt

############################################################
# Next we take the newly create .sai files and 
# convet them into one .sam file
############################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa sampe -a -P /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.826T_1.sai 1mil.826T_2.sai 1mil.826T_1.txt 1mil.826T_2.txt >1mil.826T.bwa.sam

[bwa_sai2sam_pe_core] convert to sequence coordinate...
[infer_isize] (25, 50, 75) percentile: (158, 187, 223)
[infer_isize] low and high boundaries: 70 and 353 for estimating avg and std
.
.
.
[bwa_sai2sam_pe_core] 1000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa sampe -a -P /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.826T_1.sai 1mil.826T_2.sai 1mil.826T_1.txt 1mil.826T_2.txt
[main] Real time: 144.281 sec; CPU: 135.601 sec

[abj15@login1 6.8.2019]$ ls
1mil.826T_1.sai  1mil.826T_1.txt  1mil.826T_2.sai  1mil.826T_2.txt  1mil.826T.bwa.sam

##################################################
# Next we convert the newly created .sam file into .bam file using samtools
# Path for samtools: /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools
##################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools view -S -b 1mil.826T.bwa.sam >1mil.826T.bwa.bam
[abj15@login1 6.8.2019]$ ls
1mil.826T_1.sai  1mil.826T_1.txt  1mil.826T_2.sai  1mil.826T_2.txt  1mil.826T.bwa.bam  1mil.826T.bwa.sam

##################################################
# Next we sort the newly created .bam file via samtools
##################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools sort 1mil.826T.bwa.bam -T tmpt.sorted -o 1mil.826T.bwa.bam.sorted
[abj15@login1 6.8.2019]$ ls
1mil.826T_1.sai  1mil.826T_1.txt  1mil.826T_2.sai  1mil.826T_2.txt  1mil.826T.bwa.bam  1mil.826T.bwa.bam.sorted  1mil.826T.bwa.sam

###################################################
# Next we index the sorted bam file .bam.sorted 
###################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools index 1mil.826T.bwa.bam.sorted
[abj15@login1 6.8.2019]$ ls
1mil.826T_1.sai  1mil.826T_1.txt  1mil.826T_2.sai  1mil.826T_2.txt  1mil.826T.bwa.bam  1mil.826T.bwa.bam.sorted  1mil.826T.bwa.bam.sorted.bai  1mil.826T.bwa.sam

###############################################################
# Using samtools convert the .bam.sorted file into a .bcf file
###############################################################
# Directory for fasta refernce file: /group/hon/hon3398o/0.course.files/Data/Reference/hg38/April5.2018.hg38.24chr.fa
# *Premission denied to above .fa file

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools mpileup -g -d 8000 -f /group/hon/hon3398o/0.course.files/Data/Reference/hg38/April5.2018.hg38.24chr.fa 1mil.826T.bwa.bam.sorted > 1mil.826T.bcf
[E::fai_build3] Failed to open FASTA index /group/hon/hon3398o/0.course.files/Data/Reference/hg38/April5.2018.hg38.24chr.fa.fai : Permission denied

############################################################
# Called hg38.24chr.fa from old group project for hon3398o
# Path for hg38.24chr.fa: /home/abj15/hon3398o/Presentations/Group.Pres/Run.3/hg38.24chr.fa

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools mpileup -g -d 8000 -f /home/abj15/hon3398o/Presentations/Group.Pres/Run.3/hg38.24chr.fa 1mil.826T.bwa.bam.sorted > 1mil.826T.bcf
[abj15@login1 6.8.2019]$ ls
1mil.826T_1.sai  1mil.826T_2.sai  1mil.826T.bcf      1mil.826T.bwa.bam.sorted      1mil.826T.bwa.sam
1mil.826T_1.txt  1mil.826T_2.txt  1mil.826T.bwa.bam  1mil.826T.bwa.bam.sorted.bai
[abj15@login1 6.8.2019]$ wc -l *
     33602 1mil.826T_1.sai
   4000000 1mil.826T_1.txt
     32758 1mil.826T_2.sai
   4000000 1mil.826T_2.txt
    548940 1mil.826T.bcf
    701552 1mil.826T.bwa.bam
    432171 1mil.826T.bwa.bam.sorted
      5736 1mil.826T.bwa.bam.sorted.bai
   2000456 1mil.826T.bwa.sam
  11755215 total



##############################################################
# Next use bcftools to convert the .bcf file into a .vcf file 
# Path for bcftools: /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools
###############################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools call -c -v 1mil.826T.bcf -o 1mil.826T.vcf
Note: none of --samples-file, --ploidy or --ploidy-file given, assuming all sites are diploid
[abj15@login1 6.8.2019]$ wc -l 1mil.826T.vcf
13022 1mil.826T.vcf

########################################
# Remove the headers from the .vcf file
########################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools view -H 1mil.826T.vcf > noheaders.1mil.826T.vcf
[abj15@login1 6.8.2019]$ wc -l noheaders.1mil.826T.vcf
12536 noheaders.1mil.826T.vcf

###########################################################################################
###########################################################################################

# 827T: we take the last 4 million lines aka last 1 million reads 
# Working Directory: /home/abj15/Research.Project/Datasets/827T/6.8.2019
##############################################
# Next we run bwa and samtools on 827T Pair-End Dataset to create .bam files
##############################################

[abj15@login1 6.8.2019]$ tail -4000000 ../827T_1_sequence.txt >1mil.827T_1.txt
[abj15@login1 6.8.2019]$ tail -4000000 ../827T_2_sequence.txt >1mil.827T_2.txt
[abj15@login1 6.8.2019]$ ls
1mil.827T_1.txt  1mil.827T_2.txt

##########################################################
# Next we run bwa on the two newly created files
# Path for bwa: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa
# align to hg38
# Path for hg38: /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 
# First we create .sai files of both 827T_1 and 827T_2
###########################################################
[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.827T_1.txt > 1mil.827T_1.sai

[bwa_aln_core] calculate SA coordinate... 34.54 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 33.44 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 33.10 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 786432 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 26.62 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 1000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.827T_1.txt
[main] Real time: 33.299 sec; CPU: 143.681 sec

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.827T_2.txt > 1mil.827T_2.sai

[bwa_aln_core] calculate SA coordinate... 34.48 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 34.40 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 33.89 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 786432 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 27.16 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 1000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.827T_2.txt
[main] Real time: 39.119 sec; CPU: 151.200 sec

[abj15@login1 6.8.2019]$ ls
1mil.827T_1.sai  1mil.827T_1.txt  1mil.827T_2.sai  1mil.827T_2.txt


############################################################
# Next we take the newly create .sai files and 
# convet them into one .sam file
############################################################
[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa sampe -a -P /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.827T_1.sai 1mil.827T_2.sai 1mil.827T_1.txt 1mil.827T_2.txt >1mil.827T.bwa.sam
[bwa_sai2sam_pe_core] convert to sequence coordinate...
[infer_isize] (25, 50, 75) percentile: (158, 189, 228)
[infer_isize] low and high boundaries: 70 and 368 for estimating avg and std
[infer_isize] inferred external isize from 222512 pairs: 196.263 +/- 51.188
.
.
.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa sampe -a -P /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.827T_1.sai 1mil.827T_2.sai 1mil.827T_1.txt 1mil.827T_2.txt
[main] Real time: 151.659 sec; CPU: 141.023 sec

[abj15@login1 6.8.2019]$ wc -l *
     34187 1mil.827T_1.sai
   4000000 1mil.827T_1.txt
     33776 1mil.827T_2.sai
   4000000 1mil.827T_2.txt
   2000456 1mil.827T.bwa.sam
  10068419 total

##################################################
# Next we convert the newly created .sam file into .bam file using samtools
# Path for samtools: /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools
##################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools view -S -b 1mil.827T.bwa.sam > 1mil.827T.bwa.bam
[abj15@login1 6.8.2019]$ ls
1mil.827T_1.sai  1mil.827T_1.txt  1mil.827T_2.sai  1mil.827T_2.txt  1mil.827T.bwa.bam  1mil.827T.bwa.sam

##################################################
# Next we sort the newly created .bam file via samtools
##################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools sort 1mil.827T.bwa.bam -T tmpt.sorted -o 1mil.827T.bwa.bam.sorted
[abj15@login1 6.8.2019]$ ls
1mil.827T_1.sai  1mil.827T_1.txt  1mil.827T_2.sai  1mil.827T_2.txt  1mil.827T.bwa.bam  1mil.827T.bwa.bam.sorted  1mil.827T.bwa.sam

###################################################
# Next we index the sorted bam file .bam.sorted 
###################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools index 1mil.827T.bwa.bam.sorted
[abj15@login1 6.8.2019]$ ls
1mil.827T_1.sai  1mil.827T_1.txt  1mil.827T_2.sai  1mil.827T_2.txt  1mil.827T.bwa.bam  1mil.827T.bwa.bam.sorted  1mil.827T.bwa.bam.sorted.bai  1mil.827T.bwa.sam

###############################################################
# Using samtools convert the .bam.sorted file into a .bcf file
###############################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools mpileup -g -d 8000 -f /home/abj15/hon3398o/Presentations/Group.Pres/Run.3/hg38.24chr.fa 1mil.827T.bwa.bam.sorted > 1mil.827T.bcf

[abj15@login1 6.8.2019]$ ls
1mil.827T_1.sai  1mil.827T_2.sai  1mil.827T.bcf      1mil.827T.bwa.bam.sorted      1mil.827T.bwa.sam
1mil.827T_1.txt  1mil.827T_2.txt  1mil.827T.bwa.bam  1mil.827T.bwa.bam.sorted.bai

##############################################################
# Next use bcftools to convert the .bcf file into a .vcf file 
# Path for bcftools: /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools
###############################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools call -c -v 1mil.827T.bcf -o 1mil.827T.vcf
Note: none of --samples-file, --ploidy or --ploidy-file given, assuming all sites are diploid
[abj15@login1 6.8.2019]$ ls
1mil.827T_1.sai  1mil.827T_2.sai  1mil.827T.bcf      1mil.827T.bwa.bam.sorted      1mil.827T.bwa.sam
1mil.827T_1.txt  1mil.827T_2.txt  1mil.827T.bwa.bam  1mil.827T.bwa.bam.sorted.bai  1mil.827T.vcf

########################################
# Remove the headers from the .vcf file
########################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools view -H 1mil.827T.vcf > noheader.1mil.827T.vcf
[abj15@login1 6.8.2019]$ wc -l *
     34187 1mil.827T_1.sai
   4000000 1mil.827T_1.txt
     33776 1mil.827T_2.sai
   4000000 1mil.827T_2.txt
    599185 1mil.827T.bcf
    697810 1mil.827T.bwa.bam
    433375 1mil.827T.bwa.bam.sorted
      7048 1mil.827T.bwa.bam.sorted.bai
   2000456 1mil.827T.bwa.sam
     14750 1mil.827T.vcf
     14264 noheader.1mil.827T.vcf
  11834851 total

#############################################################################################
#############################################################################################

#########################################################
#
# 832T: we take the last 4 million lines aka last 1 million reads 
# Working Directory: /home/abj15/Research.Project/Datasets/832T/6.8.2019
#########################################################

[abj15@login1 6.8.2019]$ tail -4000000 ../832T_1_sequence.txt > 1mil.832T_1.txt
[abj15@login1 6.8.2019]$ tail -4000000 ../832T_2_sequence.txt > 1mil.832T_2.txt
[abj15@login1 6.8.2019]$ ls
1mil.832T_1.txt  1mil.832T_2.txt

##########################################################
# Next we run bwa on the two newly created files
# Path for bwa: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa
# align to hg38
# Path for hg38: /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 
# First we create .sai files of both 832T_1 and 832T_2
###########################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.832T_1.txt > 1mil.832T_1.sai

[bwa_aln_core] calculate SA coordinate... ^[[A32.64 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 32.67 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 31.49 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 786432 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 25.41 sec
[bwa_aln_core] write to the disk... 0.01 sec
[bwa_aln_core] 1000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.832T_1.txt

[main] Real time: 31.633 sec; CPU: 136.541 sec

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.832T_2.txt > 1mil.832T_2.sai
[bwa_aln_core] calculate SA coordinate... 33.22 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 31.69 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 32.87 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 786432 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 23.96 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 1000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.832T_2.txt
[main] Real time: 38.711 sec; CPU: 143.074 sec

[abj15@login1 6.8.2019]$ wc -l *
    33736 1mil.832T_1.sai
  4000000 1mil.832T_1.txt
    32764 1mil.832T_2.sai
  4000000 1mil.832T_2.txt
  8066500 total

############################################################
# Next we take the newly create .sai files and 
# convet them into one .sam file
############################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa sampe -a -P /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.832T_1.sai 1mil.832T_2.sai 1mil.832T_1.txt 1mil.832T_2.txt > 1mil.832T.bwa.sam
[bwa_sai2sam_pe_core] convert to sequence coordinate...
[infer_isize] (25, 50, 75) percentile: (165, 194, 230)
[infer_isize] low and high boundaries: 70 and 360 for estimating avg and std
.
.
.
[bwa_sai2sam_pe_core] 1000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa sampe -a -P /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.832T_1.sai 1mil.832T_2.sai 1mil.832T_1.txt 1mil.832T_2.txt
[main] Real time: 130.262 sec; CPU: 118.256 sec

[abj15@login1 6.8.2019]$ ls
1mil.832T_1.sai  1mil.832T_1.txt  1mil.832T_2.sai  1mil.832T_2.txt  1mil.832T.bwa.sam

##################################################
# Next we convert the newly created .sam file into .bam file using samtools
# Path for samtools: /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools
##################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools view -S -b 1mil.832T.bwa.sam >1mil.832T.bwa.bam
[abj15@login1 6.8.2019]$ wc -l *
     33736 1mil.832T_1.sai
   4000000 1mil.832T_1.txt
     32764 1mil.832T_2.sai
   4000000 1mil.832T_2.txt
    714561 1mil.832T.bwa.bam
   2000456 1mil.832T.bwa.sam
  10781517 total

##################################################
# Next we sort the newly created .bam file via samtools
##################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools sort 1mil.832T.bwa.bam -T tmpt.sorted -o 1mil.832T.bwa.bam.sorted

###################################################
# Next we index the sorted bam file .bam.sorted 
###################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools index 1mil.832T.bwa.bam.sorted
[abj15@login1 6.8.2019]$ ls
1mil.832T_1.sai  1mil.832T_1.txt  1mil.832T_2.sai  1mil.832T_2.txt  1mil.832T.bwa.bam  1mil.832T.bwa.bam.sorted  1mil.832T.bwa.bam.sorted.bai  1mil.832T.bwa.sam

###############################################################
# Using samtools convert the .bam.sorted file into a .bcf file
###############################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools mpileup -g -d 8000 -f /home/abj15/hon3398o/Presentations/Group.Pres/Run.3/hg38.24chr.fa 1mil.832T.bwa.bam.sorted > 1mil.832T.bcf
[abj15@login1 6.8.2019]$ wc -l *
     33736 1mil.832T_1.sai
   4000000 1mil.832T_1.txt
     32764 1mil.832T_2.sai
   4000000 1mil.832T_2.txt
    642126 1mil.832T.bcf
    714561 1mil.832T.bwa.bam
    444096 1mil.832T.bwa.bam.sorted
      6935 1mil.832T.bwa.bam.sorted.bai
   2000456 1mil.832T.bwa.sam
  11874674 total

##############################################################
# Next use bcftools to convert the .bcf file into a .vcf file 
# Path for bcftools: /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools
###############################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools call -c -v 1mil.832T.bcf -o 1mil.832T.vcf
Note: none of --samples-file, --ploidy or --ploidy-file given, assuming all sites are diploid

########################################
# Remove the headers from the .vcf file
########################################
[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools view -H 1mil.832T.vcf > noheader.1mil832T.vcf
[abj15@login1 6.8.2019]$ wc -l *
     33736 1mil.832T_1.sai
   4000000 1mil.832T_1.txt
     32764 1mil.832T_2.sai
   4000000 1mil.832T_2.txt
    642126 1mil.832T.bcf
    714561 1mil.832T.bwa.bam
    444096 1mil.832T.bwa.bam.sorted
      6935 1mil.832T.bwa.bam.sorted.bai
   2000456 1mil.832T.bwa.sam
     15183 1mil.832T.vcf
     14697 noheader.1mil832T.vcf
  11904554 total
#############################################################################################
#############################################################################################

#########################################################
#
# 847T: we take the last 4 million lines aka last 1 million reads 
# Working Directory: /home/abj15/Research.Project/Datasets/847T/6.8.2019
#########################################################

[abj15@login1 6.8.2019]$ tail -4000000 ../847T_1_sequence.txt > 1mil.847T_1.txt
[abj15@login1 6.8.2019]$ tail -4000000 ../847T_2_sequence.txt > 1mil.847T_2.txt
[abj15@login1 6.8.2019]$ ls
1mil.847T_1.txt  1mil.847T_2.txt

##########################################################
# Next we run bwa on the two newly created files
# Path for bwa: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa
# align to hg38
# Path for hg38: /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 
# First we create .sai files of both 847T_1 and 847T_2
###########################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.847T_1.txt > 1mil.847T_1.sai

[bwa_aln_core] calculate SA coordinate... 32.66 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 31.74 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 32.06 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 786432 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 25.69 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 1000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.847T_1.txt
[main] Real time: 31.306 sec; CPU: 136.550 sec

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.847T_2.txt > 1mil.847T_2.sai

[bwa_aln_core] calculate SA coordinate... 32.58 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 32.77 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 32.54 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 786432 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 25.17 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 1000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.847T_2.txt
[main] Real time: 34.806 sec; CPU: 140.629 sec

[abj15@login1 6.8.2019]$ ls
1mil.847T_1.sai  1mil.847T_1.txt  1mil.847T_2.sai  1mil.847T_2.txt

############################################################
# Next we take the newly create .sai files and 
# convet them into one .sam file
############################################################
[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa sampe -a -P /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.847T_1.sai 1mil.847T_2.sai 1mil.847T_1.txt 1mil.847T_2.txt > 1mil.847T.bwa.sam
[bwa_sai2sam_pe_core] convert to sequence coordinate...
[infer_isize] (25, 50, 75) percentile: (157, 186, 222)
.
.
.
[bwa_sai2sam_pe_core] 1000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa sampe -a -P /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.847T_1.sai 1mil.847T_2.sai 1mil.847T_1.txt 1mil.847T_2.txt
[main] Real time: 158.201 sec; CPU: 147.733 sec

[abj15@login1 6.8.2019]$ wc -l *
     34607 1mil.847T_1.sai
   4000000 1mil.847T_1.txt
     33499 1mil.847T_2.sai
   4000000 1mil.847T_2.txt
   2000456 1mil.847T.bwa.sam
  10068562 total

##################################################
# Next we convert the newly created .sam file into .bam file using samtools
# Path for samtools: /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools
##################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools view -S -b 1mil.847T.bwa.sam > 1mil.847T.bwa.bam
[abj15@login1 6.8.2019]$ ls
1mil.847T_1.sai  1mil.847T_1.txt  1mil.847T_2.sai  1mil.847T_2.txt  1mil.847T.bwa.bam  1mil.847T.bwa.sam

##################################################
# Next we sort the newly created .bam file via samtools
##################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools sort 1mil.847T.bwa.bam -T tmpt.sorted -o 1mil.847T.bwa.bam.sorted
[abj15@login1 6.8.2019]$ ls
1mil.847T_1.sai  1mil.847T_1.txt  1mil.847T_2.sai  1mil.847T_2.txt  1mil.847T.bwa.bam  1mil.847T.bwa.bam.sorted  1mil.847T.bwa.sam

###################################################
# Next we index the sorted bam file .bam.sorted 
###################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools index 1mil.847T.bwa.bam.sorted
[abj15@login1 6.8.2019]$ ls
1mil.847T_1.sai  1mil.847T_1.txt  1mil.847T_2.sai  1mil.847T_2.txt  1mil.847T.bwa.bam  1mil.847T.bwa.bam.sorted  1mil.847T.bwa.bam.sorted.bai  1mil.847T.bwa.sam

###############################################################
# Using samtools convert the .bam.sorted file into a .bcf file
###############################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools mpileup -g -d 8000 -f /home/abj15/hon3398o/Presentations/Group.Pres/Run.3/hg38.24chr.fa 1mil.847T.bwa.bam.sorted > 1mil.847T.bcf

[abj15@login1 6.8.2019]$ wc -l *
     34607 1mil.847T_1.sai
   4000000 1mil.847T_1.txt
     33499 1mil.847T_2.sai
   4000000 1mil.847T_2.txt
    491704 1mil.847T.bcf
    710112 1mil.847T.bwa.bam
    428902 1mil.847T.bwa.bam.sorted
      5407 1mil.847T.bwa.bam.sorted.bai
   2000456 1mil.847T.bwa.sam
  11704687 total

##############################################################
# Next use bcftools to convert the .bcf file into a .vcf file 
# Path for bcftools: /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools
###############################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools call -c -v 1mil.847T.bcf -o 1mil.847T.vcf
Note: none of --samples-file, --ploidy or --ploidy-file given, assuming all sites are diploid

########################################
# Remove the headers from the .vcf file
########################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools view -H 1mil.847T.vcf > noheader.1mil.847T.vcf
[abj15@login1 6.8.2019]$ wc -l *
     34607 1mil.847T_1.sai
   4000000 1mil.847T_1.txt
     33499 1mil.847T_2.sai
   4000000 1mil.847T_2.txt
    491704 1mil.847T.bcf
    710112 1mil.847T.bwa.bam
    428902 1mil.847T.bwa.bam.sorted
      5407 1mil.847T.bwa.bam.sorted.bai
   2000456 1mil.847T.bwa.sam
     11583 1mil.847T.vcf
     11097 noheader.1mil.847T.vcf
  11727367 total

#############################################################################################
#############################################################################################

#########################################################
#
# 850T: we take the last 4 million lines aka last 1 million reads 
# Working Directory: /home/abj15/Research.Project/Datasets/850T/6.8.2019
#########################################################

[abj15@login1 6.8.2019]$ tail -4000000 ../850T_1_sequence.txt > 1mil.850T_1.txt
[abj15@login1 6.8.2019]$ tail -4000000 ../850T_2_sequence.txt > 1mil.850T_2.txt
[abj15@login1 6.8.2019]$ ls
1mil.850T_1.txt  1mil.850T_2.txt

##########################################################
# Next we run bwa on the two newly created files
# Path for bwa: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa
# align to hg38
# Path for hg38: /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 
# First we create .sai files of both 850T_1 and 850T_2
###########################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.850T_1.txt > 1mil.850T_1.sai

[bwa_aln_core] calculate SA coordinate... 35.00 sec
[bwa_aln_core] write to the disk... 0.05 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 34.67 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 33.88 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 786432 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 27.62 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 1000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.850T_1.txt
[main] Real time: 45.285 sec; CPU: 157.363 sec

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.850T_2.txt > 1mil.850T_2.sai

[bwa_aln_core] calculate SA coordinate... 35.28 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 35.62 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 30.83 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 786432 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 27.06 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 1000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa aln -t 8 -n 2 -I /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.850T_2.txt
[main] Real time: 34.637 sec; CPU: 145.972 sec

[abj15@login1 6.8.2019]$ wc -l *
    35554 1mil.850T_1.sai
  4000000 1mil.850T_1.txt
    35702 1mil.850T_2.sai
  4000000 1mil.850T_2.txt
  8071256 total

############################################################
# Next we take the newly create .sai files and 
# convet them into one .sam file
############################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa sampe -a -P /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.850T_1.sai 1mil.850T_2.sai 1mil.850T_1.txt 1mil.850T_2.txt > 1mil.850T.bwa.sam
.
.
.
[main] Version: 0.7.17-r1188
[main] CMD: /group/hon/hon3398o/0.course.files/software/bwa-0.7.17/bwa sampe -a -P /group/hon/hon3398o/0.course.files/Data/Reference/align.index/hg38.align.index/bwa-0.7.17.hg38.index/hg38.fa 1mil.850T_1.sai 1mil.850T_2.sai 1mil.850T_1.txt 1mil.850T_2.txt
[main] Real time: 152.740 sec; CPU: 143.272 sec
[abj15@login1 6.8.2019]$ ls
1mil.850T_1.sai  1mil.850T_1.txt  1mil.850T_2.sai  1mil.850T_2.txt  1mil.850T.bwa.sam

##################################################
# Next we convert the newly created .sam file into .bam file using samtools
# Path for samtools: /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools
##################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools view -S -b 1mil.850T.bwa.sam > 1mil.850T.bwa.bam
[abj15@login1 6.8.2019]$ ls
1mil.850T_1.sai  1mil.850T_1.txt  1mil.850T_2.sai  1mil.850T_2.txt  1mil.850T.bwa.bam  1mil.850T.bwa.sam

##################################################
# Next we sort the newly created .bam file via samtools
##################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools sort 1mil.850T.bwa.bam -T tmpt.sorted -o 1mil.850T.bwa.bam.sorted
[abj15@login1 6.8.2019]$ ls
1mil.850T_1.sai  1mil.850T_1.txt  1mil.850T_2.sai  1mil.850T_2.txt  1mil.850T.bwa.bam  1mil.850T.bwa.bam.sorted  1mil.850T.bwa.sam

###################################################
# Next we index the sorted bam file .bam.sorted 
###################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools index 1mil.850T.bwa.bam.sorted
[abj15@login1 6.8.2019]$ wc -l *
     35554 1mil.850T_1.sai
   4000000 1mil.850T_1.txt
     35702 1mil.850T_2.sai
   4000000 1mil.850T_2.txt
    720664 1mil.850T.bwa.bam
    465970 1mil.850T.bwa.bam.sorted
      7040 1mil.850T.bwa.bam.sorted.bai
   2000456 1mil.850T.bwa.sam
  11265386 total

###############################################################
# Using samtools convert the .bam.sorted file into a .bcf file
###############################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/samtools-1.7/samtools mpileup -g -d 8000 -f /home/abj15/hon3398o/Presentations/Group.Pres/Run.3/hg38.24chr.fa 1mil.850T.bwa.bam.sorted > 1mil.850T.bcf

[abj15@login1 6.8.2019]$ ls
1mil.850T_1.sai  1mil.850T_2.sai  1mil.850T.bcf      1mil.850T.bwa.bam.sorted      1mil.850T.bwa.sam
1mil.850T_1.txt  1mil.850T_2.txt  1mil.850T.bwa.bam  1mil.850T.bwa.bam.sorted.bai

##############################################################
# Next use bcftools to convert the .bcf file into a .vcf file 
# Path for bcftools: /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools
###############################################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools call -c -v 1mil.850T.bcf -o 1mil.850T.vcf
Note: none of --samples-file, --ploidy or --ploidy-file given, assuming all sites are diploid

########################################
# Remove the headers from the .vcf file
########################################

[abj15@login1 6.8.2019]$ /group/hon/hon3398o/0.course.files/software/bcftools-1.7/bcftools view -H 1mil.850T.vcf > noheader.1mil.850T.vcf
[abj15@login1 6.8.2019]$ wc -l *
     35554 1mil.850T_1.sai
   4000000 1mil.850T_1.txt
     35702 1mil.850T_2.sai
   4000000 1mil.850T_2.txt
    956296 1mil.850T.bcf
    720664 1mil.850T.bwa.bam
    465970 1mil.850T.bwa.bam.sorted
      7040 1mil.850T.bwa.bam.sorted.bai
   2000456 1mil.850T.bwa.sam
     24291 1mil.850T.vcf
     23805 noheader.1mil.850T.vcf
  12269778 total